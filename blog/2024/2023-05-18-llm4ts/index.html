<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd"> <html><body> <h1 id="llm4ts-two-stage-fine-tuning-for-time-series-forecasting-with-pre-trained-llms">LLM4TS: Two-Stage Fine-Tuning for Time-Series Forecasting with Pre-Trained LLMs</h1> <h2 id="method">Method</h2> <p><img src="/assets/img/pic/llm4ts/structure.jpg" alt="Overall Architecture"></p> <h2 id="time-series-alignment">Time-Series Alignment</h2> <p>Perform autoregressive processing on time-series data to analyze the relationship between inputs and outputs.</p> <h3 id="instance-normalization">Instance Normalization</h3> <p>Normalize the entire data instance, which is part of the data preprocessing.</p> <h3 id="time-series-tokenization">Time-Series Tokenization</h3> <p>A typical data processing method using channel-independent strategies combined with patching. <img src="/assets/img/pic/llm4ts/patch.jpg" alt="Time-Series Tokenization Diagram"></p> <h3 id="three-encodings-for-patched-time-series-data">Three Encodings for Patched Time-Series Data</h3> <ul> <li> <strong>Token Embedding Layer</strong>: Use a 1D convolutional layer as the token embedding layer.</li> <li> <strong>Positional Layer</strong>: Use a trainable lookup table to identify the position of each patch.</li> <li> <strong>Temporal Embedding Layer</strong>: Achieve dual-level aggregation. <ul> <li>First, use a trainable lookup table for each temporal attribute (e.g., second, minute) to map each attribute to a high-dimensional space, then sum these mappings to form a unified temporal embedding representation.</li> <li>Each patch may contain multiple timestamps, and pooling methods are used to extract the final temporal embedding, usually by taking the first timestamp in the patch as the representative of the entire patch.</li> </ul> </li> </ul> <h3 id="partial-freezing-and-tunable-layers">Partial Freezing and Tunable Layers</h3> <p>Freeze certain parts of the model while keeping some layers trainable to optimize model performance.</p> <ul> <li><strong>Layer Normalization Tuning</strong></li> <li><strong>Low-Rank Adaptation (LoRA)</strong></li> </ul> <h2 id="forecasting-fine-tuning-strategy">Forecasting Fine-Tuning Strategy</h2> <p>Adopt the initial linear probing followed by full fine-tuning (LP-FT) strategy, whose superiority lies in its dual-phase approach:</p> <ul> <li>First, optimize the output layer to minimize adjustments during fine-tuning (preserving the effectiveness of the feature extractor in OOD (Out-Of-Distribution) scenarios).</li> <li>Then conduct full fine-tuning to adapt the model to specific tasks (improving ID (In-Distribution) accuracy).</li> </ul> </body></html>